(this["webpackJsonplca-tool-gui"]=this["webpackJsonplca-tool-gui"]||[]).push([[0],{296:function(e,t,n){e.exports=n(461)},301:function(e,t,n){},311:function(e,t,n){},461:function(e,t,n){"use strict";n.r(t);var a,l,r=n(0),i=n.n(r),o=n(22),c=n.n(o),u=(n(301),n(12)),m=n(51),s=(n(205),n(206),n(543)),d=n(272),g=Object(d.a)({palette:{simulated:{main:"#ef6c00",light:"#ff9d3f",dark:"#b53d00"}}}),E=(n(304),n(136)),b=n(525),p=n(553),f=n(529),h=n(109),v=n(86),y=n(37),O=n(10),A={buildingActions:{setBuildings:function(e){return{type:"SET_BUILDINGS",payload:e}},selectBuildings:function(e){return{type:"SELECT_BUILDINGS",payload:e}},deselectAllBuildings:function(){return{type:"DESELECT_ALL_BUILDINGS"}}},uiActions:{setMaterialsGroupBy:function(e){return{type:"SET_CONTENT_TYPE",payload:e}},setDisplayMode:function(e){return{type:"SET_DISPLAY_MODE",payload:e}},toggleCanSelectMultiple:function(){return{type:"TOGGLE_CAN_SELECT_MULTIPLE"}},toggleSimulationMode:function(){return{type:"TOGGLE_SIMULATION_MODE"}}},elementAndMaterialActions:{setBuildingElements:function(e){return{type:"SET_BUILDING_ELEMENTS",payload:e}},setMaterialInventory:function(e){return{type:"SET_MATERIAL_INVENTORY",payload:e}},selectBuildingElement:function(e){return{type:"SELECT_BUILDING_ELEMENT",payload:e}},addToElementRoute:function(e){return{type:"ADD_TO_ELEMENT_ROUTE",payload:e}},setElementRoute:function(e){return{type:"SET_BUILDING_ELEMENT_ROUTE",payload:e}},hoverBuildingElement:function(e){return{type:"HOVER_BUILDING_ELEMENT",payload:e}},stopHoverBuildingElement:function(e){return{type:"STOP_HOVER_BUILDING_ELEMENT",payload:e}},setSimulatedData:function(e){return{type:"SET_SIMULATED_DATA",payload:e}},setMaterialProducts:function(e){return{type:"SET_MATERIAL_PRODUCTS",payload:e}},setSimulatedMaterialProducts:function(e){return{type:"SET_SIMULATED_MATERIAL_PRODUCTS",payload:e}}},settingsActions:{setEEMetric:function(e){return{type:"SET_EE_METRIC",name:e.name,checked:e.checked}}},userActions:{setCurrentUser:function(e){return{type:"SET_CURRENT_USER",payload:e}}}},j=n(465),C=n(527),S=n(528),_=n(9),w=n(18),N=n(2),B=n(119),T=n.n(B),I=n(4);!function(e){e.Category="category",e.BuildingElement="buildingElement",e.Product="product"}(a||(a={})),function(e){e.A1A3="Material production",e.A4="Transportation to building site",e.B4="Replacement",e.B4m="Material replacements",e.B4t="Transportation of material replacements",e.B6="Operational energy use",e.B7="Operational water use"}(l||(l={}));Object(b.a)((function(){return Object(p.a)({simulatedField:{color:g.palette.simulated.main}})}));var x=function(e){var t=e.value;return t?parseFloat(t).toLocaleString():0},M=function(e){return i.a.createElement(_.c,Object.assign({formatterComponent:x},e))},L=function(e){var t=e.value;return i.a.createElement("b",null,t)},k=function(e){return i.a.createElement(_.c,Object.assign({formatterComponent:L},e))},R=function(e){e.getMessage;var t=e.column,n=Object(y.a)(e,["getMessage","column"]),a="";switch(t.name){case"A1A3":a=l.A1A3;break;case"A4":a=l.A4;break;case"B4":a=l.B4;break;case"B4_m":a=l.B4m;break;case"B4_t":a=l.B4t;break;case"GWP_B6":a=l.B6;break;case"GWP_B7":a=l.B7;break;case"FU":a="Functional unit";break;case"RSL_mi":case"RSL":a="Reference service life";break;default:a="Sort by ".concat(t.name)}return i.a.createElement(w.j.SortLabel,Object.assign({column:t,getMessage:function(){return a}},n))},D=n(35),P=function e(){Object(D.a)(this,e)};P.columns=[{name:"building_identifier",title:"ID"},{name:"building_name",title:"Building name"},{name:"project",title:"Project"},{name:"country",title:"Country"},{name:"city",title:"City"},{name:"typology",title:"Typology"},{name:"construction_type",title:"Construction type"},{name:"built_status",title:"Built status"},{name:"energy_ambition_level",title:"Energy ambition level"},{name:"calculation_method",title:"Calculation method"},{name:"main_data_source",title:"Data source"},{name:"study_type",title:"Study type"},{name:"study_year",title:"Study year"},{name:"floor_area",title:"Floor area (m\xb2)"},{name:"lifetime",title:"Lifetime"},{name:"A1A3",title:"A1-A3"},{name:"A4",title:"A4"},{name:"B4_m",title:"B4 (m)"},{name:"B4_t",title:"B4 (t)"},{name:"GWP_B6",title:"B6"},{name:"GWP_B7",title:"B7"},{name:"heated_volume",title:"Heated volume"},{name:"area_footprint",title:"Area footprint"},{name:"area_roof",title:"Area roof"},{name:"area_wall",title:"Area wall"},{name:"area_windowAndDoor",title:"Area window and door"},{name:"heatloss_number",title:"Heatloss number"},{name:"comments",title:"Comments"}],P.columnExtensions=[{columnName:"building_identifier",width:80},{columnName:"building_name",width:200,wordWrapEnabled:!0},{columnName:"project",width:120},{columnName:"country",width:110},{columnName:"city",width:120},{columnName:"typology",width:130},{columnName:"construction_type",width:160},{columnName:"built_status",width:120},{columnName:"energy_ambition_level",width:180},{columnName:"calculation_method",width:170},{columnName:"main_data_source",width:120},{columnName:"study_type",width:160},{columnName:"study_year",width:110},{columnName:"lifetime",width:100},{columnName:"floor_area",width:150},{columnName:"heated_volume",width:150},{columnName:"area_footprint",width:150},{columnName:"area_roof",width:150},{columnName:"area_wall",width:150},{columnName:"area_windowAndDoor",width:150},{columnName:"heatloss_number",width:150},{columnName:"comments",width:400,wordWrapEnabled:!0}],P.defaultHiddenColumnNames=["country","built_status","energy_ambition_level","main_data_source","calculation_method","heated_volume","area_footprint","area_roof","area_wall","area_windowAndDoor","heatloss_number","comments"],P.tableColumnVisibilityColumnExtensions=[{columnName:"building_identifier",togglingEnabled:!1},{columnName:"building_name",togglingEnabled:!1}];var F=P,U=n(526),G=(n(311),function(){return r.createElement("div",{className:"loading-shading-mui"},r.createElement(U.a,{className:"loading-icon-mui",size:50,thickness:5}))}),z=n(550),W=n(545);function V(e){var t=i.a.useState(!0),n=Object(u.a)(t,2),a=n[0],l=n[1],r=function(e,t){"clickaway"!==t&&l(!1)};return i.a.createElement(z.a,{open:a,autoHideDuration:6e3,onClose:r},i.a.createElement(W.a,{onClose:r,severity:e.severity,elevation:6,variant:"filled"},e.message))}var q=Object(b.a)((function(e){return Object(p.a)({selected:{backgroundColor:"#EEEEEE"},customRow:{"@supports (-webkit-backdrop-filter: none) or (backdrop-filter: none)":{"&:hover":{cursor:"pointer","& > *":{backdropFilter:"brightness(97%)"},"& .buildingTableFixedCell":{filter:"brightness(97%)"}}},"@supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none))":{"&:hover":{cursor:"pointer",backgroundColor:"#F6F6F6","& .buildingTableFixedCell":{backgroundColor:"#F6F6F6"}}}}})})),H=function(e){return e[Object.keys(e)[0]]},Y=function(e){return i.a.createElement(w.b.Root,Object.assign({},e,{style:{height:"100%"}}))},K=function(e){var t,n=e.className,a=e.highlighted,l=e.selectByRowClick,r=e.onToggle,o=Object(y.a)(e,["className","highlighted","selectByRowClick","onToggle"]),c=q();return i.a.createElement(w.e.Row,Object.assign({},o,{className:Object(I.a)((t={},Object(v.a)(t,c.selected,a),Object(v.a)(t,c.customRow,!0),t),n),onClick:function(e){l&&(e.stopPropagation(),r())}}))},X=function(e){var t=Object.assign({},e);return i.a.createElement(w.h.Cell,Object.assign({},t,{className:"buildingTableFixedCell"}))},$=function(e){return e.map((function(e){return{columnName:e,predicate:function(){return!1}}}))};var J=function(){var e=Object(O.b)(),t=Object(O.c)((function(e){return e.buildings})),n=Object(r.useState)(F.columns),a=Object(u.a)(n,1)[0],l=Object(r.useState)(F.columnExtensions),o=Object(u.a)(l,1)[0],c=Object(r.useState)(!1),m=Object(u.a)(c,2),s=m[0],d=m[1],g=Object(r.useState)(null),E=Object(u.a)(g,2),b=E[0],p=E[1],f=Object(r.useState)(),h=Object(u.a)(f,2),v=(h[0],h[1]),y=Object(r.useState)(F.defaultHiddenColumnNames),B=Object(u.a)(y,1)[0],I=Object(r.useState)(F.tableColumnVisibilityColumnExtensions),x=Object(u.a)(I,1)[0],L=Object(r.useState)([w.k.COLUMN_TYPE,"building_name"]),k=Object(u.a)(L,1)[0],D=Object(O.c)((function(e){return e.canSelectMultipleBuildings})),P=Object(r.useState)(["A1A3","A4","B4_t","B4_m","GWP_B6","GWP_B7"]),U=Object(u.a)(P,1)[0];function z(e){if(!e.ok)throw Error(e.statusText);return e}Object(r.useEffect)((function(){W()}),[]);var W=function(){if(!s){d(!0);var n="https://us-central1-blcad-gui.cloudfunctions.net/api/buildings";console.log("URL: ",n),fetch(n).then(z).then((function(e){return e.json()})).then((function(n){e(A.buildingActions.setBuildings(n)),d(!1),console.log("Fetched rows: ",t)})).catch((function(e){console.log("Error getting building data:",e),p(e),d(!1)}))}},q=Object(r.useCallback)(T.a.debounce((function(e){console.log("Changed search term: ",e),v(e)}),300),[]),J=Object(r.useState)($(B)),Q=Object(u.a)(J,2),Z=Q[0],ee=Q[1],te=Object(r.useState)([]),ne=Object(u.a)(te,2),ae=ne[0],le=ne[1];return i.a.createElement(j.a,{style:{height:"100%"}},i.a.createElement(w.b,{rows:t,columns:a,getRowId:H,rootComponent:Y},i.a.createElement(M,{for:U}),i.a.createElement(_.q,{onValueChange:q}),i.a.createElement(_.k,{columnExtensions:Z}),i.a.createElement(_.s,null),i.a.createElement(_.m,null),i.a.createElement(_.r,{selection:ae,onSelectionChange:function(n){if(D){le(n);var a=t.filter((function(e){return n.includes(e.idbuildings)}));e(A.buildingActions.selectBuildings(a))}else{var l=n.find((function(e){return-1===ae.indexOf(e)}));if(void 0!==l){le([l]);var r=n[n.length-1];console.log("Selected row: ",r);var i=t.find((function(e){return e.idbuildings===r}));void 0!==i&&e(A.buildingActions.selectBuildings([i]))}else le([]),e(A.buildingActions.deselectAllBuildings())}}}),i.a.createElement(w.o,{height:"auto",columnExtensions:o}),i.a.createElement(w.j,{showSortingControls:!0,sortLabelComponent:R}),i.a.createElement(w.k,{selectByRowClick:!0,highlightRow:!0,showSelectionColumn:D,rowComponent:K}),i.a.createElement(w.h,{leftColumns:k,cellComponent:X}),i.a.createElement(w.f,{defaultHiddenColumnNames:B,columnExtensions:x,onHiddenColumnNamesChange:function(e){return ee($(e))}}),i.a.createElement(w.n,null),i.a.createElement(N.k,{name:"toolbarContent"},i.a.createElement(N.m,null),i.a.createElement(C.a,{control:i.a.createElement(S.a,{checked:D,onChange:function(){e(A.uiActions.toggleCanSelectMultiple()),e(A.buildingActions.deselectAllBuildings()),le([])},name:"checkedB",color:"primary"}),label:"Select multiple"})),i.a.createElement(w.d,null),i.a.createElement(w.a,null)),s&&i.a.createElement(G,null),b&&i.a.createElement(V,{message:"Couldn't load data, the server may be down.",severity:"error"}))},Q=n(534),Z=n(554),ee={apiKey:"AIzaSyBb6VK_mu8s1T2gxWYg0HWvoOY_bSARrKc",authDomain:"blcad-gui.firebaseapp.com",projectId:"blcad-gui",storageBucket:"blcad-gui.appspot.com",messagingSenderId:"904167128860",appId:"1:904167128860:web:53f89c35f19b3dc64104d9",measurementId:"G-5Y4F1X620N"};n(462),n(312),n(463);m.a.initializeApp(ee);m.a.auth(),m.a.firestore();var te=m.a.firestore();function ne(e){var t="anonymous",n=m.a.auth().currentUser;return n&&null!==n.email&&(t=n.email),te.collection("users").doc(t).collection("simulatedData").doc(e).get()}var ae=n(532),le=n(522),re=n(546),ie=n(535),oe=n(531),ce=n(469),ue=n(547),me=n(551),se=n(536),de=n(7),ge=n(15),Ee=n(548),be=n(557),pe=n(191),fe=n.n(pe),he=n(267),ve=n.n(he),ye=n(466),Oe=n(160),Ae=n.n(Oe),je=n(266),Ce=n.n(je),Se=n(81),_e=n.n(Se),we=function e(){Object(D.a)(this,e)};we.columns=[{name:"idlevels",title:"Code"},{name:"name",title:"Name"},{name:"A1A3",title:"A1-A3"},{name:"A4",title:"A4"},{name:"B4_m",title:"B4 (m)"},{name:"B4_t",title:"B4 (t)"}],we.columnExtensions=[{columnName:"idlevels",width:80},{columnName:"name",width:180,wordWrapEnabled:!0},{columnName:"A1A3",width:130},{columnName:"A4",width:130},{columnName:"B4_m",width:130},{columnName:"B4_t",width:130}],we.defaultHiddenColumnNames=[],we.tableColumnVisibilityColumnExtensions=[{columnName:"name",togglingEnabled:!1}];var Ne=we,Be=n(40),Te=function(e,t){var n=e.filter((function(e){return e.idparent===t.idlevels}));return void 0!==n?n:[]},Ie=function(e,t){var n=e.filter((function(e){return e.idbuilding_elements===t.idbuilding_elements}));return void 0!==n?n:[]},xe=function(e){if(e.value.length>15){var t=e.value.split(" ");if(t.length>2){var n=Math.ceil(t.length/2);return t.slice(0,n).join(" ")+"\n"+t.slice(n).join(" ")}return t.join("\n")}return e.value},Me=function(e){return e.sort((function(e,t){return e.A1A3+e.A4+e.B4_m+e.B4_t-(t.A1A3+t.A4+t.B4_m+t.B4_t)})),e},Le=function(e){return e.map((function(e){e.idmaterials,e.sourceType,e.RSL_mi,e.source,e.dataType,e.dataYear,e.density,e.EEf_A1A3,e.RSL,e.comments,e.parentId;return Object(y.a)(e,["idmaterials","sourceType","RSL_mi","source","dataType","dataYear","density","EEf_A1A3","RSL","comments","parentId"])}))},ke=function(e){var t=[];return e.reduce((function(e,n){return e[n.name]||(e[n.name]=Object(Be.a)(Object(Be.a)({},n),{},{idmaterialInventory:n.parentId,quantity:0,A1A3:0,A4:0,B4_m:0,B4_t:0,parentId:null,buildingElementName:n.buildingElementName}),t.push(e[n.name])),e[n.name].quantity+=n.quantity,e[n.name].A1A3+=n.A1A3,e[n.name].A4+=n.A4,e[n.name].B4_m+=n.B4_m,e[n.name].B4_t+=n.B4_t,e[n.name].buildingElementName!==n.buildingElementName&&(e[n.name].buildingElementName="..."),e}),{}),t},Re=function(e,t){var n=[];return t&&(n=e.map((function(e){return t[e.idmaterialInventory]?Object(Be.a)(Object(Be.a)({},e),t[e.idmaterialInventory]):e}))),n},De=Object(b.a)((function(e){return Object(p.a)({customRow:{"&:hover":{backgroundColor:"#F5F5F5",cursor:"pointer"}}})})),Pe=function(e){var t=Object(O.b)(),n=Object(O.c)((function(e){return e.buildingElements})),a=Object(O.c)((function(e){return e.selectedBuildingElement})),l=Object(r.useState)(Ne.columns),o=Object(u.a)(l,1)[0],c=Object(r.useState)(Ne.columnExtensions),m=Object(u.a)(c,1)[0],s=Object(r.useState)(["A1A3","A4","B4_t","B4_m"]),d=Object(u.a)(s,1)[0],g=Object(r.useState)(["name"]),E=(Object(u.a)(g,1)[0],Object(r.useState)(["name"])),b=Object(u.a)(E,1)[0],p=function(e){t(A.elementAndMaterialActions.selectBuildingElement(e)),t(A.elementAndMaterialActions.addToElementRoute(e))},f={edit:function(e){var t=e.onExecute;return i.a.createElement(me.a,{title:"Go to sub-elements"},i.a.createElement(ye.a,{onClick:t},i.a.createElement(_e.a,null)))}},h=Te(n,a);return i.a.createElement(w.b,{rows:h,columns:o},i.a.createElement(k,{for:b}),i.a.createElement(M,{for:d}),i.a.createElement(_.s,null),i.a.createElement(_.m,null),i.a.createElement(_.e,{onCommitChanges:function(){}}),i.a.createElement(w.o,{columnExtensions:m,rowComponent:function(e){var t=e.row,n=(e.style,Object(y.a)(e,["row","style"]));return i.a.createElement(w.o.Row,Object.assign({},n,{id:"tableRow"+t.idbuilding_elements,className:De().customRow,onClick:function(){return p(t)}}))},height:500}),i.a.createElement(w.j,{showSortingControls:!0,sortLabelComponent:R}),i.a.createElement(w.g,{showEditCommand:!0,commandComponent:function(e){var t=e.id,n=e.onExecute,a=f[t];return i.a.createElement(a,{onExecute:n})},width:80}))},Fe=n(14),Ue=function(e){switch(e.seriesName){case"A1-A3":return l.A1A3;case"A4":return l.A4;case"B4":return l.B4;case"B4 (m)":return l.B4m;case"B4 (t)":return l.B4t}},Ge=Object(b.a)((function(e){return Object(p.a)({chart:{padding:e.spacing(2)},argumentAxisLabel:{fill:"#767676"}})})),ze=function(){var e=Object(r.useRef)(null),t={force:!0,animate:!0},n=Object(r.useRef)(new ResizeObserver((function(n){var a;console.log("Size changed"),null===e||void 0===e||null===(a=e.current)||void 0===a||a.instance.render(t)}))),a=Object(r.useCallback)((function(e){null!==e?n.current.observe(e):n.current&&n.current.disconnect()}),[n.current]),l=Object(O.b)(),o=Object(O.c)((function(e){return e.buildingElements})),c=Object(O.c)((function(e){return e.selectedBuildingElement})),m=Object(r.useState)([]),s=Object(u.a)(m,2),d=s[0],g=s[1];Object(r.useEffect)((function(){var e=E(c),t=[];e.forEach((function(e){var n={name:e.idlevels+" - "+e.name,id:String(e.idbuilding_elements),A1A3:Number(e.A1A3)||0,A4:Number(e.A4)||0,B4_m:Number(e.B4_m)||0,B4_t:Number(e.B4_t)||0};t.push(n)}));var n=Me(t);g(n)}),[c]);var E=function(e){var t=o.filter((function(t){return t.idparent===e.idlevels}));return void 0!==t?t:[]},b=Ge();return i.a.createElement(j.a,{ref:a},i.a.createElement(Fe.Chart,{className:b.chart,dataSource:d,palette:"Material",rotated:!0,onPointClick:function(e){var t=e.target,n=Number(t.data.id),a=o.find((function(e){return e.idbuilding_elements===n}));void 0!==a&&(l(A.elementAndMaterialActions.selectBuildingElement(a)),l(A.elementAndMaterialActions.addToElementRoute(a)))},onDrawn:function(e){e.element.querySelectorAll(".dxc-markers rect").forEach((function(e){e.style.cursor="pointer"})),e.element.querySelector(".dxc-arg-elements").childNodes.forEach((function(e){e.style.cursor="pointer"}))},ref:e},i.a.createElement(Fe.Size,{height:500}),i.a.createElement(Fe.CommonSeriesSettings,{argumentField:"name",type:"stackedBar",barWidth:40,hoverMode:"allArgumentPoints"}),i.a.createElement(Fe.Series,{valueField:"A1A3",name:"A1-A3"}),i.a.createElement(Fe.Series,{valueField:"A4",name:"A4"}),i.a.createElement(Fe.Series,{valueField:"B4_m",name:"B4 (m)"}),i.a.createElement(Fe.Series,{valueField:"B4_t",name:"B4 (t)"}),i.a.createElement(Fe.ValueAxis,null,i.a.createElement(Fe.Title,{text:"kgCO2e",font:{size:14}})),i.a.createElement(Fe.ArgumentAxis,null,i.a.createElement(Fe.Label,{customizeText:xe})),i.a.createElement(Fe.Legend,{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"top",customizeHint:Ue}),i.a.createElement(Fe.Tooltip,{enabled:!0,location:"edge",customizeTooltip:function(e){return{text:"<b>".concat(e.seriesName,"</b>\n ").concat(e.valueText)}},zIndex:1200,arrowLength:6,format:{format:function(e){return parseFloat(e).toLocaleString()}},interactive:!0})))},We=n(159),Ve=n(265),qe=n.n(Ve),He=function e(){Object(D.a)(this,e)};He.columns=[{name:"name",title:"Name"},{name:"quantity",title:"Quantity"},{name:"FU",title:"FU"},{name:"sourceType",title:"Data source"},{name:"A1A3",title:"A1-A3"},{name:"A4",title:"A4"},{name:"B4_m",title:"B4 (m)"},{name:"B4_t",title:"B4 (t)"},{name:"RSL_mi",title:"RSL"},{name:"materialCat",title:"Category"},{name:"buildingElementName",title:"Building element"},{name:"source",title:"Source"},{name:"dataType",title:"Data type"},{name:"dataYear",title:"Data year"},{name:"density",title:"Density"},{name:"EEf_A1A3",title:"EEf_A1A3"},{name:"country",title:"Country"},{name:"city",title:"City"},{name:"comments",title:"Comments"}],He.columnExtensions=[{columnName:"idmaterialInventory",width:80},{columnName:"name",width:270,wordWrapEnabled:!0},{columnName:"dataType",width:120},{columnName:"sourceType",width:120},{columnName:"source",width:200,wordWrapEnabled:!0},{columnName:"dataYear",width:100},{columnName:"FU",width:70},{columnName:"EEf_A1A3",width:110},{columnName:"comments",width:400},{columnName:"materialCat",width:150},{columnName:"quantity",width:110},{columnName:"RSL_mi",width:80},{columnName:"A1A3",width:130},{columnName:"A4",width:130},{columnName:"B4_m",width:130},{columnName:"B4_t",width:130},{columnName:"buildingElementName",width:160,wordWrapEnabled:!0}],He.defaultHiddenColumnNames=["source","dataType","dataYear","comments","EEf_A1A3","density","country","city"],He.tableColumnVisibilityColumnExtensions=[{columnName:"name",togglingEnabled:!1}],He.decimalColumns=["quantity","EEf_A1A3","A1A3","A4","B4_t","B4_m","RSL_mi"],He.groupSummaryItems=[{columnName:"quantity",type:"sum",showInGroupFooter:!1,alignByColumn:!0},{columnName:"FU",type:"staticValue",showInGroupFooter:!1,alignByColumn:!0},{columnName:"sourceType",type:"staticValue",showInGroupFooter:!1,alignByColumn:!0},{columnName:"materialCat",type:"staticValue",showInGroupFooter:!1,alignByColumn:!0},{columnName:"RSL_mi",type:"avg",showInGroupFooter:!1,alignByColumn:!0},{columnName:"A1A3",type:"sum",showInGroupFooter:!1,alignByColumn:!0},{columnName:"A4",type:"sum",showInGroupFooter:!1,alignByColumn:!0},{columnName:"B4_m",type:"sum",showInGroupFooter:!1,alignByColumn:!0},{columnName:"B4_t",type:"sum",showInGroupFooter:!1,alignByColumn:!0}],He.editingStateColumnExtensions=[{columnName:"idmaterialInventory",editingEnabled:!1},{columnName:"name",editingEnabled:!1},{columnName:"buildingElementName",editingEnabled:!1},{columnName:"FU",editingEnabled:!1},{columnName:"materialCat",editingEnabled:!1},{columnName:"RSL_mi",editingEnabled:!1},{columnName:"dataType",editingEnabled:!1},{columnName:"dataYear",editingEnabled:!1},{columnName:"comments",editingEnabled:!1}];var Ye=He,Ke=n(98),Xe=n.n(Ke),$e=n(524),Je=(n(520),Object(b.a)((function(){return Object(p.a)({cell:{padding:g.spacing(1)},indentCell:{padding:0},groupButton:{height:g.spacing(4),width:g.spacing(4)},lookupEditCell:{padding:g.spacing(1)},inputRoot:{width:"100%"},selectMenu:{position:"absolute !important"},editCell:{paddingTop:g.spacing(0),paddingBottom:g.spacing(0),paddingLeft:g.spacing(2),paddingRight:g.spacing(0)},simulatedField:{color:g.palette.simulated.main}})})),function(e){var t=e.children,n=e.style,a=Object(y.a)(e,["children","style"]);return i.a.createElement(w.o.Cell,Object.assign({},a,{children:null===a.row.parentId?t:null,style:Object(Be.a)({paddingTop:"0px",paddingBottom:"0px",paddingLeft:"16px",paddingRight:"0px"},n)}))}),Qe=function(e){var t=e.value,n=e.style,a=Object(y.a)(e,["value","style"]);return i.a.createElement(w.o.Cell,Object.assign({},a,{style:Object(Be.a)({},n)}),i.a.createElement(me.a,{title:"Simulated value"},i.a.createElement("span",{style:{color:g.palette.simulated.main,fontWeight:"bold"}},"number"===typeof t?t.toLocaleString():t)))},Ze=n(468),et=n(523),tt=n(549),nt=n(533),at=n(530);var lt=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n},rt=Object(b.a)((function(){return Object(p.a)({labelAsterisk:{color:g.palette.simulated.main,fontWeight:"bolder",fontSize:"large"},subtitleAsterisk:{color:g.palette.simulated.main,fontWeight:"bolder"},dialogContent:{paddingTop:g.spacing(2),paddingBottom:g.spacing(2),paddingLeft:g.spacing(3),paddingRight:g.spacing(3),overflow:"auto"}})})),it=["TestSource","EPD","Ecoinvent","Other","Custom","na","Klimatre","PEP"],ot=function(e){var t=e.row,n=e.onChange,a=e.onApplyChanges,o=e.onCancelChanges,c=e.open,m=Object(r.useState)(t),s=Object(u.a)(m,2),d=s[0],g=s[1],E=Object(r.useState)(t.sourceType),b=Object(u.a)(E,2),p=b[0],v=b[1],y=Object(r.useState)(t.A1A3),A=Object(u.a)(y,2),j=A[0],C=A[1],S=Object(O.c)((function(e){return e.materialProducts}));Object(O.c)((function(e){return e.simulatedMaterialProducts}));Object(r.useEffect)((function(){var e=S.find((function(e){return e.idmaterialInventory===t.idmaterialInventory}));void 0!==e&&(g(e),v(t.sourceType),C(t.A1A3))}),[t.idmaterialInventory]);var _=rt();return i.a.createElement(tt.a,{open:c,onClose:o,fullWidth:!0,maxWidth:"xs"},i.a.createElement(at.a,{disableTypography:!0},i.a.createElement(h.a,{variant:"h6",component:"h2"},"Edit material details"),i.a.createElement(h.a,{noWrap:!0,variant:"subtitle2",component:"h3"},t.name)),i.a.createElement("div",{className:_.dialogContent},p!==d.sourceType&&i.a.createElement(h.a,{variant:"body2",component:"p",color:"textSecondary"},"Edited/affected fields are marked with"," ",i.a.createElement(h.a,{variant:"body1",component:"span",display:"inline",className:_.subtitleAsterisk},"*")),i.a.createElement(f.a,{container:!0,spacing:3},i.a.createElement(f.a,{item:!0,xs:6},i.a.createElement(Ze.a,null,i.a.createElement(Z.a,{select:!0,required:p!==d.sourceType,margin:"normal",name:"sourceType",label:"Data source",variant:"outlined",value:p||" ",onChange:function(e){if(v(e.target.value),"TestSource"===e.target.value){var t=(l=d.A1A3,lt(.6*l,3));C(t),n({target:{name:"A1A3",value:t}})}else if(e.target.value===d.sourceType){C(d.A1A3);var a={target:{name:"A1A3",value:d.A1A3}};n(a)}var l;n(e)},InputLabelProps:{classes:{asterisk:_.labelAsterisk}}},it.map((function(e){return i.a.createElement(le.a,{key:e,value:e,disabled:!(e===d.sourceType||"TestSource"===e)},e)}))))),i.a.createElement(f.a,{item:!0,xs:6},i.a.createElement(Ze.a,null,i.a.createElement(me.a,{enterDelay:500,placement:"bottom",title:l.A1A3},i.a.createElement(Z.a,{required:j!==d.A1A3,margin:"normal",name:"A1A3",label:"A1-A3",value:j||"0",onChange:n,disabled:!0,InputLabelProps:{classes:{asterisk:_.labelAsterisk}}})),i.a.createElement(me.a,{enterDelay:500,placement:"bottom",title:l.A4},i.a.createElement(Z.a,{margin:"normal",name:"A4",label:"A4",value:t.A4||"0",onChange:n,disabled:!0})),i.a.createElement(me.a,{enterDelay:500,placement:"bottom",title:l.B4m},i.a.createElement(Z.a,{margin:"normal",name:"B4_m",label:"B4 (m)",value:t.B4_m||"0",onChange:n,disabled:!0})),i.a.createElement(me.a,{enterDelay:500,placement:"bottom",title:l.B4t},i.a.createElement(Z.a,{margin:"normal",name:"B4_t",label:"B4 (t)",value:t.B4_t||"0",onChange:n,disabled:!0})))))),i.a.createElement(nt.a,null,i.a.createElement(et.a,{onClick:o,color:"primary"},"Cancel"),i.a.createElement(et.a,{onClick:a,color:"primary"},"Save")))},ct=i.a.memo((function(e){var t=e.popupComponent;return i.a.createElement(N.g,null,i.a.createElement(N.k,{name:"popupEditing"},i.a.createElement(N.l,null,(function(e,n){var a,l,r=e.rows,o=e.getRowId,c=e.editingRowIds,m=e.createRowChange,s=e.rowChanges,d=n.changeRow,g=n.commitChangedRows,E=n.stopEditRows,b=n.cancelChangedRows,p=Object(u.a)(c,1);l=p[0];var f=r.filter((function(e){return o(e)===l}))[0];a=Object(Be.a)(Object(Be.a)({},f),s[l]);var h=c,v=c.length>0;return i.a.createElement(t,{open:v,row:a,onChange:function(e){var t=e.target,n=t.name,r=t.value,i={rowId:l,change:m(a,r,n)};d(i)},onApplyChanges:function(){E({rowIds:h}),g({rowIds:h})},onCancelChanges:function(){E({rowIds:h}),b({rowIds:h})}})}))),i.a.createElement(N.k,{name:"root"},i.a.createElement(N.m,null),i.a.createElement(N.m,{name:"popupEditing"})))})),ut=function(e){return e.idmaterialInventory},mt=function(e){return e.map((function(e){return{columnName:e,predicate:function(){return!1}}}))},st={edit:function(e){var t=e.onExecute;return i.a.createElement(me.a,{title:"Edit material"},i.a.createElement(ye.a,{onClick:t},i.a.createElement(qe.a,null)))}},dt=function(e){var t=e.id,n=e.onExecute,a=st[t];return i.a.createElement(a,{onExecute:n})},gt=function(e){var t=e.row,n=e.style,a=Object(y.a)(e,["row","style"]);return i.a.createElement(w.m.Cell,Object.assign({},a,{style:Object(Be.a)({fontWeight:null===t.parentId?"bold":void 0},n)}))},Et=function(e){var t=Object(O.b)(),n=Object(O.c)((function(e){return e.selectedBuildings})),a=Object(O.c)((function(e){return e.materialProducts})),l=(Object(O.c)((function(e){return e.simulatedMaterialProducts})),Object(O.c)((function(e){return e.simulatedData}))),o=Object(O.c)((function(e){return e.isSimulationModeActive})),c=Object(r.useState)([]),s=Object(u.a)(c,2),d=s[0],g=s[1],E=Object(r.useState)(Ye.columns),b=Object(u.a)(E,1)[0],p=Object(r.useState)(Ye.columnExtensions),f=Object(u.a)(p,1)[0],h=Object(r.useState)(Ye.defaultHiddenColumnNames),v=Object(u.a)(h,1)[0],y=Object(r.useState)(Ye.tableColumnVisibilityColumnExtensions),j=Object(u.a)(y,1)[0],C=Object(r.useState)(Ye.decimalColumns),S=Object(u.a)(C,1)[0];Object(r.useEffect)((function(){g(e.data)}),[e.data]);var N=Object(r.useState)(),B=Object(u.a)(N,2),I=(B[0],B[1]),x=Object(r.useCallback)(T.a.debounce((function(e){console.log("Changed search term: ",e),I(e)}),300),[]),L=Object(r.useState)(mt(v)),k=Object(u.a)(L,2),D=k[0],P=k[1],F=Object(r.useState)([]),U=Object(u.a)(F,2),G=U[0],z=U[1],W=Object(r.useState)([w.g.COLUMN_TYPE,"name"]),V=Object(u.a)(W,1)[0];return i.a.createElement(w.b,{rows:d,columns:b,getRowId:ut},i.a.createElement(_.N,{expandedRowIds:G,onExpandedRowIdsChange:z}),i.a.createElement(_.b,{getChildRows:function(e,t){var n=t.filter((function(t){return t.parentId===(e?e.idmaterialInventory:null)}));return n.length?n:null}}),i.a.createElement(_.q,{onValueChange:x}),i.a.createElement(_.k,{columnExtensions:D}),i.a.createElement(_.s,null),i.a.createElement(_.m,null),i.a.createElement(_.e,{onCommitChanges:function(e){var r=e.changed;console.log("Changed: ",r);var i=Object.keys(r)[0],o=a.find((function(e){return String(e.idmaterialInventory)===i}));if(void 0!==Object.values(r)[0]&&void 0!==o){for(var c=Object(Be.a)(Object(Be.a)({},l),r),s=0,d=Object.entries(c[i]);s<d.length;s++){var E=Object(u.a)(d[s],2),b=E[0];E[1]===Object(We.getKeyValue)(b,o)&&delete c[i][b]}0===Object.keys(c[i]).length&&delete c[i];var p=Re(a,c);!function(e,t){var n="anonymous",a=m.a.auth().currentUser;a&&null!==a.email&&(n=a.email),te.collection("users").doc(n).collection("simulatedData").doc(e).set(t).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)}))}(String(n[0].idbuildings),c),t(A.elementAndMaterialActions.setSimulatedData(c)),t(A.elementAndMaterialActions.setSimulatedMaterialProducts(p)),g(p)}}}),i.a.createElement(w.o,{columnExtensions:f,cellComponent:o?function(e){return function(e,t){var n=e.column,a=e.row;return a.idmaterialInventory in t&&n.name in t[a.idmaterialInventory]?i.a.createElement(Qe,e):i.a.createElement(w.o.Cell,e)}(e,l)}:function(e){return i.a.createElement(w.o.Cell,e)}}),i.a.createElement(M,{for:S}),i.a.createElement(w.j,{showSortingControls:!0,sortLabelComponent:R}),i.a.createElement(w.m,{for:"name",cellComponent:gt}),i.a.createElement(w.g,{showEditCommand:o,commandComponent:dt,cellComponent:Je,width:o?70:.1}),i.a.createElement(w.h,{leftColumns:V}),i.a.createElement(ct,{popupComponent:ot}),i.a.createElement(w.f,{defaultHiddenColumnNames:v,columnExtensions:j,onHiddenColumnNamesChange:function(e){return P(mt(e))}}),i.a.createElement(w.n,null),i.a.createElement(w.d,null),i.a.createElement(w.a,null))},bt=Object(b.a)((function(e){return Object(p.a)({chart:{padding:e.spacing(2)},argumentAxisLabel:{fill:"#767676"}})})),pt=function(e){var t,n,a=Object(r.useRef)(null),l={force:!0,animate:!0},o=Object(r.useRef)(new ResizeObserver((function(e){var t;console.log("Size changed"),null===a||void 0===a||null===(t=a.current)||void 0===t||t.instance.render(l)}))),c=Object(r.useCallback)((function(e){null!==e?o.current.observe(e):o.current&&o.current.disconnect()}),[o.current]),m=Object(r.useState)([]),s=Object(u.a)(m,2),d=s[0],E=s[1],b=Object(r.useState)([]),p=Object(u.a)(b,2),f=p[0],h=p[1],v=Object(O.c)((function(e){return e.isSimulationModeActive})),y=Object(O.c)((function(e){return e.simulatedData})),A=Object(O.c)((function(e){return e.simulatedMaterialProducts}));Object(r.useEffect)((function(){var t,n,a=Me(e.data);E(a);var l=[null===(t=a[a.length-1])||void 0===t?void 0:t.name,null===(n=a[a.length-11])||void 0===n?void 0:n.name];h(l)}),[e.data]);d.length;var C=bt();return i.a.createElement(j.a,{ref:c},i.a.createElement(Fe.Chart,{className:C.chart,dataSource:d,palette:"Material",rotated:!0,onDrawn:function(e){v&&e.element.querySelector(".dxc-arg-elements").childNodes.forEach((function(e){var t="";if(e.childNodes.length>1){var n=[];e.childNodes.forEach((function(e){n.push(e.innerHTML)})),t=n.join(" ")}else t=e.innerHTML;(function(e){var t;return(null===(t=A.find((function(t){return t.name===e})))||void 0===t?void 0:t.idmaterialInventory)||0})(t)in y&&(e.style.fill=g.palette.simulated.main,e.style.fontWeight=500)}))},ref:a,onOptionChanged:function(e){if("argumentAxis.visualRange"===e.fullName){var t=e.value;h(t)}}},i.a.createElement(Fe.Size,{height:500}),i.a.createElement(Fe.CommonSeriesSettings,{argumentField:"name",type:"stackedBar",barWidth:40,hoverMode:"allArgumentPoints"}),i.a.createElement(Fe.Series,{valueField:"A1A3",name:"A1-A3"}),i.a.createElement(Fe.Series,{valueField:"A4",name:"A4"}),i.a.createElement(Fe.Series,{valueField:"B4_m",name:"B4 (m)"}),i.a.createElement(Fe.Series,{valueField:"B4_t",name:"B4 (t)"}),i.a.createElement(Fe.ValueAxis,null,i.a.createElement(Fe.Title,{text:"kgCO2e",font:{size:14}})),console.log("Name 0: ",null===(t=d[d.length-1])||void 0===t?void 0:t.name),console.log("Name 8: ",null===(n=d[d.length-11])||void 0===n?void 0:n.name),i.a.createElement(Fe.ArgumentAxis,{visualRange:f},i.a.createElement(Fe.Label,{customizeText:xe})),i.a.createElement(Fe.ScrollBar,{visible:!0}),i.a.createElement(Fe.ZoomAndPan,{argumentAxis:"pan"}),i.a.createElement(Fe.Legend,{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"top",customizeHint:Ue}),i.a.createElement(Fe.Tooltip,{enabled:!0,location:"edge",customizeTooltip:function(e){return{text:"<b>".concat(e.seriesName,"</b>\n ").concat(e.valueText)}},zIndex:1200,arrowLength:6,format:{format:function(e){return parseFloat(e).toLocaleString()}},interactive:!0})))},ft=function(e){Object(O.b)();var t=Object(O.c)((function(e){return e.displayMode})),n=Object(O.c)((function(e){return e.materialInventory})),a=Object(O.c)((function(e){return e.materialProducts})),l=Object(O.c)((function(e){return e.simulatedMaterialProducts})),o=Object(O.c)((function(e){return e.isSimulationModeActive})),c=Object(O.c)((function(e){return e.simulatedData})),m=Object(r.useState)([]),s=Object(u.a)(m,2),d=s[0],g=s[1],E=Object(r.useState)([]),b=Object(u.a)(E,2),p=b[0],h=b[1];return Object(r.useEffect)((function(){var t,r;r=o?l:e.materials?ke(e.materials):a;var i=(null!==(t=e.materials)&&void 0!==t?t:n).map((function(e){return{idmaterialInventory:e.idmaterialInventory,name:"Inventory: "+String(e.idmaterialInventory),buildingElementName:e.buildingElementName,quantity:e.quantity,FU:e.FU,A1A3:e.A1A3||0,A4:e.A4||0,B4_m:e.B4_m||0,B4_t:e.B4_t||0,RSL_mi:e.RSL_mi,parentId:e.parentId}})),c=r.concat(i),u=Le(r);g(c),h(u)}),[o,c]),i.a.createElement("div",null,i.a.createElement(f.a,{container:!0,spacing:3},i.a.createElement(f.a,{item:!0,xs:!0},"table"==t?i.a.createElement(j.a,null,i.a.createElement(Et,{data:d})):i.a.createElement(pt,{data:p}))))},ht=Object(b.a)((function(e){return Object(p.a)({breadCrumbs:{marginTop:"3px"},infoIcon:{color:e.palette.text.secondary},infoContainer:{marginBottom:e.spacing(1)},infoIconGridItem:{height:"28px"}})})),vt=Object(de.a)((function(e){return{root:{backgroundColor:e.palette.grey[100],height:e.spacing(3),color:e.palette.grey[800],fontWeight:e.typography.fontWeightRegular,"&:hover, &:focus":{backgroundColor:e.palette.grey[300]},"&:active":{boxShadow:e.shadows[1],backgroundColor:Object(ge.b)(e.palette.grey[300],.12)}}}}))(be.a),yt=Object(de.a)((function(e){return{root:{backgroundColor:e.palette.secondary.light,height:e.spacing(3),fontWeight:e.typography.fontWeightRegular,"&:hover, &:focus":{},"&:active":{boxShadow:e.shadows[1]}}}}))(be.a),Ot=function(e){var t=Object(O.b)(),n=Object(O.c)((function(e){return e.buildingElements})),a=Object(O.c)((function(e){return e.materialInventory})),l=Object(O.c)((function(e){return e.selectedBuildingElement})),o=Object(O.c)((function(e){return e.buildingElementRoute})),c=Object(O.c)((function(e){return e.displayMode}));Object(r.useEffect)((function(){var e=n.find((function(e){return 0===e.hierarchy}));void 0!==e&&(t(A.elementAndMaterialActions.selectBuildingElement(e)),t(A.elementAndMaterialActions.setElementRoute([e])))}),[]);var m=Object(r.useState)(),s=Object(u.a)(m,2),d=s[0],g=s[1],E=Te(n,l),b=ht();return i.a.createElement("div",null,i.a.createElement(f.a,{container:!0,spacing:3,alignItems:"center"},i.a.createElement(f.a,{item:!0},i.a.createElement(me.a,{title:"Back"},i.a.createElement("span",null,i.a.createElement(ye.a,{size:"small",onClick:function(){var e=o;g(e.pop()),t(A.elementAndMaterialActions.selectBuildingElement(e[e.length-1])),t(A.elementAndMaterialActions.setElementRoute(e))},disabled:o.length<2},i.a.createElement(Ae.a,null)))),i.a.createElement(me.a,{title:"Forward"},i.a.createElement("span",null,i.a.createElement(ye.a,{size:"small",onClick:function(){var e=o;void 0!==d&&e.push(d),t(A.elementAndMaterialActions.selectBuildingElement(e[e.length-1])),t(A.elementAndMaterialActions.setElementRoute(e))},disabled:!0},i.a.createElement(Ce.a,null))))),i.a.createElement(f.a,{item:!0,xs:10},i.a.createElement(Ee.a,null,o.map((function(e,n){return n!==o.length-1?i.a.createElement(vt,{className:b.breadCrumbs,key:n,label:e.idlevels+" - "+e.name,variant:"default",icon:0===e.idlevels?i.a.createElement(fe.a,{fontSize:"small"}):void 0,color:n===o.length-1?"secondary":"default",onClick:function(){return function(e){var n=o.slice(0,e+1);t(A.elementAndMaterialActions.selectBuildingElement(n[n.length-1])),t(A.elementAndMaterialActions.setElementRoute(n))}(n)}}):i.a.createElement(yt,{className:b.breadCrumbs,key:n,label:e.idlevels+" - "+e.name,variant:"default",icon:0===e.idlevels?i.a.createElement(fe.a,{fontSize:"small"}):void 0,color:"secondary"})})))),i.a.createElement(f.a,{item:!0,xs:12},(null===E||void 0===E?void 0:E.length)?"table"===c?i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{container:!0,alignItems:"center",justify:"center",spacing:1,className:b.infoContainer},i.a.createElement(f.a,{item:!0,className:b.infoIconGridItem},i.a.createElement(ve.a,{className:b.infoIcon,fontSize:"small"})),i.a.createElement(f.a,{item:!0},i.a.createElement(h.a,{variant:"body2",color:"textSecondary",align:"center"},"Click on a building element to see its sub-elements"))),i.a.createElement(j.a,null,i.a.createElement(Pe,null))):i.a.createElement(ze,null):i.a.createElement(ft,{materials:Ie(a,l)}))))},At=function e(){Object(D.a)(this,e)};At.columns=[{name:"name",title:"Name"},{name:"quantity",title:"Quantity"},{name:"FU",title:"FU"},{name:"materialCat",title:"Category"},{name:"sourceType",title:"Data source"},{name:"RSL_mi",title:"RSL"},{name:"A1A3",title:"A1-A3"},{name:"A4",title:"A4"},{name:"B4_m",title:"B4 (m)"},{name:"B4_t",title:"B4 (t)"},{name:"source",title:"Source"},{name:"dataType",title:"Data type"},{name:"dataYear",title:"Data year"},{name:"density",title:"Density"},{name:"EEf_A1A3",title:"EEf_A1A3"},{name:"country",title:"Country"},{name:"city",title:"City"},{name:"comments",title:"Comments"}],At.columnExtensions=[{columnName:"idmaterialInventory",width:80},{columnName:"name",width:270,wordWrapEnabled:!0},{columnName:"dataType",width:120},{columnName:"sourceType",width:120},{columnName:"source",width:200,wordWrapEnabled:!0},{columnName:"dataYear",width:100},{columnName:"FU",width:70},{columnName:"EEf_A1A3",width:110},{columnName:"comments",width:400},{columnName:"materialCat",width:150},{columnName:"quantity",width:130},{columnName:"RSL_mi",width:80},{columnName:"A1A3",width:130},{columnName:"A4",width:130},{columnName:"B4_m",width:130},{columnName:"B4_t",width:130},{columnName:"buildingElementName",width:160,wordWrapEnabled:!0}],At.defaultHiddenColumnNames=["source","dataType","dataYear","comments","EEf_A1A3","density","country","city"],At.tableColumnVisibilityColumnExtensions=[{columnName:"name",togglingEnabled:!1}],At.decimalColumns=["quantity","EEf_A1A3","A1A3","A4","B4_t","B4_m","RSL_mi"],At.groupSummaryItems=[{columnName:"quantity",type:"sum",showInGroupFooter:!1,alignByColumn:!0},{columnName:"FU",type:"staticValue",showInGroupFooter:!1,alignByColumn:!0},{columnName:"sourceType",type:"staticValue",showInGroupFooter:!1,alignByColumn:!0},{columnName:"RSL_mi",type:"avg",showInGroupFooter:!1,alignByColumn:!0},{columnName:"A1A3",type:"sum",showInGroupFooter:!1,alignByColumn:!0},{columnName:"A4",type:"sum",showInGroupFooter:!1,alignByColumn:!0},{columnName:"B4_m",type:"sum",showInGroupFooter:!1,alignByColumn:!0},{columnName:"B4_t",type:"sum",showInGroupFooter:!1,alignByColumn:!0}],At.editingStateColumnExtensions=[{columnName:"idmaterialInventory",editingEnabled:!1},{columnName:"name",editingEnabled:!1},{columnName:"buildingElementName",editingEnabled:!1},{columnName:"FU",editingEnabled:!1},{columnName:"materialCat",editingEnabled:!1},{columnName:"RSL_mi",editingEnabled:!1},{columnName:"dataType",editingEnabled:!1},{columnName:"dataYear",editingEnabled:!1},{columnName:"comments",editingEnabled:!1}];var jt=At,Ct=Object(b.a)((function(e){return Object(p.a)({cell:{padding:e.spacing(1)},indentCell:{padding:0},groupButton:{height:e.spacing(4),width:e.spacing(4)},lookupEditCell:{padding:e.spacing(1)},inputRoot:{width:"100%"},selectMenu:{position:"absolute !important"}})})),St=function(e){var t=e.style,n=e.colSpan,a=e.row,l=(e.column,e.expanded),r=e.onToggle,o=(e.classes,e.children),c=(e.className,e.tableRow,e.tableColumn,e.contentComponent,e.iconComponent,e.indentCellComponent,e.inlineSummaryComponent,e.inlineSummaryItemComponent,e.summaryCellComponent,e.summaryItemComponent,e.containerComponent,e.inlineSummaries,e.getMessage,Object(y.a)(e,["style","colSpan","row","column","expanded","onToggle","classes","children","className","tableRow","tableColumn","contentComponent","iconComponent","indentCellComponent","inlineSummaryComponent","inlineSummaryItemComponent","summaryCellComponent","summaryItemComponent","containerComponent","inlineSummaries","getMessage"])),u=Ct();return i.a.createElement($e.a,Object.assign({colSpan:n,style:t,className:u.cell,onClick:function(){return r()}},c),i.a.createElement(f.a,{container:!0,alignItems:"center",justify:"space-around"},i.a.createElement(f.a,{item:!0,xs:2},i.a.createElement(ye.a,{className:u.groupButton},l?i.a.createElement(Xe.a,null):i.a.createElement(_e.a,null))),i.a.createElement(f.a,{item:!0,xs:10},i.a.createElement("span",null,i.a.createElement("strong",null,o||a.value)))))},_t=function(e){e.style;var t=e.colSpan,n=(e.row,e.column,e.expanded,e.onToggle),a=(e.classes,e.children),l=(e.className,e.tableRow,e.tableColumn,e.contentComponent,e.iconComponent,e.indentCellComponent,e.inlineSummaryComponent,e.inlineSummaryItemComponent,e.summaryCellComponent,e.summaryItemComponent,e.containerComponent,e.inlineSummaries,e.getMessage,Object(y.a)(e,["style","colSpan","row","column","expanded","onToggle","classes","children","className","tableRow","tableColumn","contentComponent","iconComponent","indentCellComponent","inlineSummaryComponent","inlineSummaryItemComponent","summaryCellComponent","summaryItemComponent","containerComponent","inlineSummaries","getMessage"])),r=Ct(),o="";switch(a.props.columnSummaries[0].type){case"sum":o="Sum";break;case"avg":o="Average";break;case"staticValue":o="Static"}return i.a.createElement($e.a,Object.assign({colSpan:t,onClick:function(){return n()},className:r.cell},l),"Static"===o?i.a.createElement("span",null,a):i.a.createElement(me.a,{title:o},i.a.createElement("span",null,a)))},wt=function(e){return e.idmaterialInventory},Nt=function(e){return e.map((function(e){return{columnName:e,predicate:function(){return!1}}}))},Bt=function(e){Object(O.b)();var t=Object(r.useState)(jt.columns),n=Object(u.a)(t,1)[0],a=Object(r.useState)(jt.columnExtensions),l=Object(u.a)(a,1)[0],o=Object(r.useState)(jt.defaultHiddenColumnNames),c=Object(u.a)(o,1)[0],m=Object(r.useState)(jt.tableColumnVisibilityColumnExtensions),s=Object(u.a)(m,1)[0],d=Object(r.useState)(jt.decimalColumns),g=Object(u.a)(d,1)[0],E=Object(r.useState)(),b=Object(u.a)(E,2),p=(b[0],b[1]),f=Object(r.useCallback)(T.a.debounce((function(e){console.log("Changed search term: ",e),p(e)}),300),[]),h=Object(r.useState)(Nt(c)),v=Object(u.a)(h,2),y=v[0],A=v[1],j=Object(r.useState)([]),C=Object(u.a)(j,2),S=(C[0],C[1],Object(r.useState)(["name"])),N=Object(u.a)(S,1)[0],B=Object(r.useState)([{columnName:"materialCat"}]),I=Object(u.a)(B,1)[0],x=Object(r.useState)(jt.groupSummaryItems),L=Object(u.a)(x,1)[0];return i.a.createElement(w.b,{rows:e.materials,columns:n,getRowId:wt},i.a.createElement(M,{for:g}),i.a.createElement(_.q,{onValueChange:f}),i.a.createElement(_.k,{columnExtensions:y}),i.a.createElement(_.s,null),i.a.createElement(_.m,null),i.a.createElement(_.i,{grouping:I}),i.a.createElement(_.u,{groupItems:L}),i.a.createElement(_.l,null),i.a.createElement(_.n,{calculator:function(e,t,n){if("staticValue"===e){if(!t.length)return null;var a=n(t[0]);return t.every((function(e){return n(e)===a}))?a:"..."}return _.n.defaultCalculator(e,t,n)}}),i.a.createElement(w.o,{columnExtensions:l}),i.a.createElement(w.j,{showSortingControls:!0,sortLabelComponent:R}),i.a.createElement(w.i,{cellComponent:St,summaryCellComponent:_t,summaryItemComponent:function(e){var t,n=e.value;return t="string"===typeof n?n:n&&n>0?parseFloat(n).toLocaleString():"0",i.a.createElement("strong",null,t)}}),i.a.createElement(w.l,null),i.a.createElement(w.h,{leftColumns:N}),i.a.createElement(w.f,{defaultHiddenColumnNames:c,columnExtensions:s,onHiddenColumnNamesChange:function(e){return A(Nt(e))}}),i.a.createElement(w.n,null),i.a.createElement(w.c,{showSortingControls:!0}),i.a.createElement(w.d,null),i.a.createElement(w.a,null))},Tt=n(162),It=Object(b.a)((function(e){return Object(p.a)({container:{position:"relative"},chart:{overflowX:"hidden"},argumentAxisLabel:{fill:"#767676"},button:{position:"absolute",top:"12px",left:"18px"}})})),xt=function(e){var t=Object(r.useRef)(null),n={force:!0,animate:!0},a=Object(r.useRef)(new ResizeObserver((function(e){var a;console.log("Size changed"),null===t||void 0===t||null===(a=t.current)||void 0===a||a.instance.render(n)}))),l=Object(r.useCallback)((function(e){null!==e?a.current.observe(e):a.current&&a.current.disconnect()}),[a.current]),o=Object(r.useState)([]),c=Object(u.a)(o,2),m=c[0],s=c[1],d=Object(r.useState)(!0),g=Object(u.a)(d,2),E=g[0],b=g[1],p=Object(r.useState)(""),f=Object(u.a)(p,2),h=f[0],v=f[1],y=Object(r.useState)(0),O=Object(u.a)(y,2),A=O[0],C=O[1];Object(r.useEffect)((function(){var e=S("");s(e),C(30*e.length+200)}),[e.data]);var S=function(t){return e.data.filter((function(e){return e.materialCat===t}))},_=It();return i.a.createElement(j.a,{className:_.container,ref:l},i.a.createElement(me.a,{title:"Back"},i.a.createElement("span",null,i.a.createElement(ye.a,{className:_.button,onClick:function(){E||(b(!0),v(""),s(S("")))},disabled:E},i.a.createElement(Ae.a,null)))),i.a.createElement(Fe.Chart,{className:_.chart,dataSource:m,palette:"Material",rotated:!0,onPointClick:function(e){E&&(b(!1),v(e.target.originalArgument),s(S(e.target.originalArgument)))},onDrawn:function(e){E&&(e.element.querySelectorAll(".dxc-markers rect").forEach((function(e){e.style.cursor="pointer"})),e.element.querySelector(".dxc-arg-elements").childNodes.forEach((function(e){e.style.cursor="pointer"})))},ref:t},""===h?i.a.createElement(Fe.Title,{text:"Click on a bar to see materials",horizontalAlignment:"center",font:{size:16,color:Tt.a[500],weight:400}}):i.a.createElement(Fe.Title,{text:h,horizontalAlignment:"center",font:{size:18,color:"black",weight:500,family:'Roboto, "Segoe UI Light", "Helvetica Neue Light", "Segoe UI", "Helvetica Neue", "Trebuchet MS", Verdana, sans-serif'}}),i.a.createElement(Fe.Size,{height:A>600?A:600}),i.a.createElement(Fe.Margin,{top:10,bottom:10,left:30,right:30}),i.a.createElement(Fe.CommonSeriesSettings,{argumentField:"name",type:"stackedBar",barWidth:50,hoverMode:"allArgumentPoints"}),i.a.createElement(Fe.Series,{valueField:"A1A3",name:"A1-A3"}),i.a.createElement(Fe.Series,{valueField:"A4",name:"A4"}),i.a.createElement(Fe.Series,{valueField:"B4_m",name:"B4 (m)"}),i.a.createElement(Fe.Series,{valueField:"B4_t",name:"B4 (t)"}),i.a.createElement(Fe.ValueAxis,null,i.a.createElement(Fe.Title,{text:"kgCO2e",font:{size:14}})),i.a.createElement(Fe.ArgumentAxis,null,i.a.createElement(Fe.Label,{customizeText:xe})),i.a.createElement(Fe.Legend,{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"top",customizeHint:Ue}),i.a.createElement(Fe.Tooltip,{enabled:!0,location:"edge",customizeTooltip:function(e){return{text:"<b>".concat(e.seriesName,"</b>\n ").concat(e.valueText)}},zIndex:1200,arrowLength:6,format:{format:function(e){return parseFloat(e).toLocaleString()}},interactive:!0})))},Mt=(Object(b.a)((function(e){return Object(p.a)({breadCrumbs:{marginBottom:e.spacing(2)},chart:{padding:e.spacing(2)},elementTable:{padding:e.spacing(2)}})})),function(e){Object(O.b)();var t=Object(O.c)((function(e){return e.displayMode})),n=(Object(O.c)((function(e){return e.materialInventory})),Object(r.useState)([])),a=Object(u.a)(n,2),l=a[0],o=a[1],c=Object(r.useState)([]),m=Object(u.a)(c,2),s=m[0],d=m[1];return Object(r.useEffect)((function(){var t=ke(e.materials),n=Le(t),a=function(e){var t=[];return e.reduce((function(e,n){return e[n.materialCat]||(e[n.materialCat]={name:n.materialCat,A1A3:0,A4:0,B4_m:0,B4_t:0,materialCat:""},t.push(e[n.materialCat])),e[n.materialCat].A1A3+=n.A1A3,e[n.materialCat].A4+=n.A4,e[n.materialCat].B4_m+=n.B4_m,e[n.materialCat].B4_t+=n.B4_t,e}),{}),t}(n),l=n.concat(a),r=Me(l);o(t),d(r)}),[]),i.a.createElement("div",null,i.a.createElement(f.a,{container:!0,spacing:3},i.a.createElement(f.a,{item:!0,xs:!0},"table"===t?i.a.createElement(j.a,null,i.a.createElement(Bt,{materials:l})):i.a.createElement(xt,{data:s}))))}),Lt=Object(de.a)({switchBase:{"&$checked":{color:g.palette.simulated.main},"&$checked + $track":{backgroundColor:g.palette.simulated.main}},checked:{},track:{}})(S.a),kt=function(){var e=Object(O.b)(),t=Object(O.c)((function(e){return e.isSimulationModeActive})),n=Object(O.c)((function(e){return e.materialsGroupBy}));return i.a.createElement(C.a,{control:i.a.createElement(Lt,{checked:t,onChange:function(){e(A.uiActions.toggleSimulationMode()),n!==a.Product&&e(A.uiActions.setMaterialsGroupBy(a.Product))},name:"simulationChecked",color:"primary"}),label:"Edit mode"})},Rt=Object(b.a)((function(e){return Object(p.a)({formControl:{marginRight:e.spacing(2),minWidth:180},verticalDivider:{marginRight:e.spacing(2),marginTop:e.spacing(1),marginBottom:e.spacing(1)}})})),Dt=function(e){var t=Object(O.b)(),n=Object(O.c)((function(e){return e.selectedBuildings})),l=Object(O.c)((function(e){return e.materialInventory})),o=Object(O.c)((function(e){return e.isSimulationModeActive})),m=Object(O.c)((function(e){return e.materialsGroupBy})),s=Object(O.c)((function(e){return e.displayMode})),d=Object(r.useState)(!1),g=Object(u.a)(d,2),E=g[0],b=g[1],p=Object(r.useState)(!1),v=Object(u.a)(p,2),y=(v[0],v[1]),j=function(e){y(e)};Object(r.useEffect)((function(){n.length&&S()}),[n]);var S=function(){var e=n[0].idbuildings,a="https://us-central1-blcad-gui.cloudfunctions.net/api",l="".concat(a,"/building_elements/").concat(e),r="".concat(a,"/material_inventory/").concat(e);E||(b(!0),Promise.all([fetch(l),fetch(r)]).then((function(e){return Promise.all(e.map((function(e){return e.json()})))})).then((function(n){ne(String(e)).then((function(e){var a,l={};e.exists&&(l=null!==(a=e.data())&&void 0!==a?a:{});var r=n[0],i=n[1],o=ke(i),u=Re(o,l);c.a.unstable_batchedUpdates((function(){t(A.elementAndMaterialActions.setBuildingElements(r)),t(A.elementAndMaterialActions.setMaterialInventory(i)),t(A.elementAndMaterialActions.setMaterialProducts(o)),t(A.elementAndMaterialActions.setSimulatedData(l)),t(A.elementAndMaterialActions.setSimulatedMaterialProducts(u)),b(!1)}))})).catch((function(e){console.log("Error getting simulation data:",e),b(!1)}))})).catch((function(){return b(!1)}))),ne(String(e))},_=Rt();return i.a.createElement("div",null,i.a.createElement(f.a,{container:!0,spacing:3,alignItems:"center",justify:"space-between",direction:"row"},i.a.createElement(f.a,{item:!0},i.a.createElement(h.a,{variant:"h5",color:"textSecondary"},"Materials")),i.a.createElement(f.a,{item:!0},i.a.createElement(f.a,{container:!0,alignItems:"center"},i.a.createElement(f.a,{item:!0},i.a.createElement(kt,null)),i.a.createElement(Q.a,{orientation:"vertical",flexItem:!0,className:_.verticalDivider}),i.a.createElement(f.a,{item:!0},i.a.createElement(me.a,{title:"Disable Edit mode to select different grouping",disableFocusListener:!o,disableHoverListener:!o,disableTouchListener:!o},i.a.createElement(oe.a,{className:_.formControl,variant:"outlined"},i.a.createElement(ae.a,null,"Group by"),i.a.createElement(ue.a,{displayEmpty:!0,value:m,label:"Group by",onChange:function(e){t(A.uiActions.setMaterialsGroupBy(e.target.value))},onMouseEnter:function(){return j(!0)},onMouseLeave:function(){return j(!1)},onOpen:function(){return j(!1)}},i.a.createElement(le.a,{value:a.Product},"Product"),i.a.createElement(le.a,{value:a.BuildingElement,disabled:o},"Building element"),i.a.createElement(le.a,{value:a.Category,disabled:o},"Category"))))),i.a.createElement(f.a,{item:!0},i.a.createElement(oe.a,{component:"fieldset"},i.a.createElement(ce.a,{component:"legend",color:"secondary"},"Display mode"),i.a.createElement(ie.a,{value:s,onChange:function(e){t(A.uiActions.setDisplayMode(e.target.value))},row:!0},i.a.createElement(C.a,{value:"table",control:i.a.createElement(re.a,null),label:"Table"}),i.a.createElement(C.a,{value:"chart",control:i.a.createElement(re.a,null),label:"Chart"}))))))),E||e.parentIsLoading?i.a.createElement(se.a,{style:{marginTop:"65px"},variant:"rect",height:350}):m===a.BuildingElement?i.a.createElement(Ot,null):m===a.Product?i.a.createElement(ft,{materials:l}):i.a.createElement(Mt,{materials:l}))},Pt=Object(b.a)((function(e){return Object(p.a)({chart:{height:200,padding:e.spacing(2)}})})),Ft=function(){var e=Object(r.useRef)(null),t={force:!0,animate:!0},n=Object(r.useRef)(new ResizeObserver((function(n){var a;console.log("Size changed"),null===e||void 0===e||null===(a=e.current)||void 0===a||a.instance.render(t)}))),a=Object(r.useCallback)((function(e){null!==e?n.current.observe(e):n.current&&n.current.disconnect()}),[n.current]),l=Object(O.c)((function(e){return e.selectedBuildings})),o=Object(O.c)((function(e){return e.simulatedMaterialProducts})),c=Object(O.c)((function(e){return e.isSimulationModeActive})),m=Object(O.c)((function(e){return e.simulatedData})),s=Object(O.c)((function(e){return e.EEMetric})),d=Object(r.useState)([]),E=Object(u.a)(d,2),b=E[0],p=E[1];Object(r.useEffect)((function(){var e,t,n,a,r={A1A3:Number(l[0].A1A3)||0,A4:Number(l[0].A4)||0,B4_m:Number(l[0].B4_m)||0,B4_t:Number(l[0].B4_t)||0};c?(e=f("A1A3")?h("A1A3"):r.A1A3,t=f("A4")?h("A4"):r.A4,n=f("B4_m")?h("B4_m"):r.B4_m,a=f("B4_t")?h("B4_t"):r.B4_t):(e=Number(l[0].A1A3)||0,t=Number(l[0].A4)||0,n=Number(l[0].B4_m)||0,a=Number(l[0].B4_t)||0),s.perSqM&&(e/=l[0].floor_area,t/=l[0].floor_area,n/=l[0].floor_area,a/=l[0].floor_area),s.perYear&&(e/=l[0].lifetime,t/=l[0].lifetime,n/=l[0].lifetime,a/=l[0].lifetime),p([{lcaPhase:"A1-A3",gwp:e},{lcaPhase:"A4",gwp:t},{lcaPhase:"B4 (m)",gwp:n},{lcaPhase:"B4 (t)",gwp:a}])}),[l[0],c,m,s]);var f=function(e){return Object.values(m).some((function(t){return e in t}))},h=function(e){return o.reduce((function(t,n){return t+(Number(Object(We.getKeyValue)(e,n))||0)}),0)},v=function(e){switch(e){case"A1-A3":return"A1A3";case"A4":return"A4";case"B4 (m)":return"B4_m";case"B4 (t)":return"B4_t";default:return""}},y="kgCO2e";s.perSqM&&(y+="/m\xb2"),s.perYear&&(y+="/year");var A=Pt();return i.a.createElement(j.a,{ref:a},i.a.createElement(Fe.Chart,{className:A.chart,dataSource:b,palette:"Material",onDrawn:function(e){c&&e.element.querySelector(".dxc-arg-elements").childNodes.forEach((function(e){var t=v(e.innerHTML);f(t)&&(e.style.fill=g.palette.simulated.main,e.style.fontWeight=500)}))},ref:e},i.a.createElement(Fe.CommonSeriesSettings,{argumentField:"lcaPhase",valueField:"gwp",type:"bar",showInLegend:!1,ignoreEmptyPoints:!0}),i.a.createElement(Fe.ValueAxis,null,i.a.createElement(Fe.Title,{text:y,font:{size:12}})),i.a.createElement(Fe.ArgumentAxis,null),i.a.createElement(Fe.SeriesTemplate,{nameField:"lcaPhase"}),i.a.createElement(Fe.Tooltip,{enabled:!0,zIndex:1200,arrowLength:6,format:{format:function(e){return parseFloat(e).toLocaleString()}},interactive:!0})))},Ut=n(268),Gt=n.n(Ut),zt=n(273),Wt=n(467),Vt=n(538),qt=n(519),Ht=n(537),Yt=Object(b.a)((function(e){return Object(p.a)({root:{width:"100%",maxWidth:360,minWidth:220},content:{width:350,padding:e.spacing(2)},formControl:{marginTop:e.spacing(3)}})}));var Kt=function(e){var t=Object(O.b)(),n=Object(O.c)((function(e){return e.EEMetric})),a=i.a.useState(null),l=Object(u.a)(a,2),r=l[0],o=l[1],c=function(e){t(A.settingsActions.setEEMetric({name:e.target.name,checked:e.target.checked}))},m=n.perSqM,s=n.perYear;return Yt(),i.a.createElement("div",null,i.a.createElement(me.a,{title:"Metric settings"},i.a.createElement(ye.a,{"aria-label":"help",onClick:function(e){o(e.currentTarget)}},i.a.createElement(Gt.a,{fontSize:e.iconSize}))),i.a.createElement(zt.a,{id:"simple-menu",anchorEl:r,keepMounted:!0,open:Boolean(r),onClose:function(){o(null)},PaperProps:{style:{width:170}}},i.a.createElement(Ht.a,null,"Metric settings"),i.a.createElement(Wt.a,null,i.a.createElement(qt.a,{id:"switch-list-label-sqm",primary:"Per m\xb2"}),i.a.createElement(Vt.a,null,i.a.createElement(S.a,{edge:"end",checked:m,onChange:c,name:"perSqM"}))),i.a.createElement(Wt.a,null,i.a.createElement(qt.a,{id:"switch-list-label-year",primary:"Per year"}),i.a.createElement(Vt.a,null,i.a.createElement(S.a,{edge:"end",checked:s,onChange:c,name:"perYear"})))))},Xt=Object(b.a)((function(e){return Object(p.a)({buildingSection:{marginBottom:e.spacing(2)},divider:{marginBottom:e.spacing(2)},materialSection:{marginTop:e.spacing(2)},buildingInfoLabels:{fontWeight:"bold"},heading:{marginBottom:e.spacing(1)},content:{padding:e.spacing(2)}})}));var $t=function(){Object(O.b)();var e=Object(O.c)((function(e){return e.selectedBuildings})),t=(Object(O.c)((function(e){return e.isSimulationModeActive})),e[0]),n=t.building_identifier,a=t.building_name,l=t.project,r=t.typology,o=t.construction_type,c=t.floor_area,u=(t.A1A3,t.A4,t.B4_m,t.B4_t,Xt());return i.a.createElement("div",{className:u.content},i.a.createElement(f.a,{container:!0,spacing:3,className:u.buildingSection},i.a.createElement(f.a,{item:!0,container:!0,alignItems:"flex-start",justify:"space-between"},i.a.createElement(f.a,{item:!0},i.a.createElement(h.a,{variant:"h4",color:"textPrimary"},a),i.a.createElement(h.a,{variant:"subtitle1",color:"textSecondary",gutterBottom:!0},n))),i.a.createElement(f.a,{item:!0,xs:6},i.a.createElement(f.a,{container:!0,alignItems:"center",justify:"space-between",className:u.heading},i.a.createElement(f.a,{item:!0},i.a.createElement(h.a,{variant:"h5",color:"textSecondary"},"General info"))),i.a.createElement("div",null,i.a.createElement(Z.a,{key:l||"project",inputProps:{readOnly:!0,disabled:!0},InputProps:{disableUnderline:!0},fullWidth:!0,label:"Project",name:"project",margin:"dense",defaultValue:l||"nil"}),i.a.createElement(Z.a,{key:r||"typology",inputProps:{readOnly:!0,disabled:!0},InputProps:{disableUnderline:!0},fullWidth:!0,label:"Typology",name:"typology",margin:"dense",defaultValue:r||"nil"}),i.a.createElement(Z.a,{key:o||"c_type",inputProps:{readOnly:!0,disabled:!0},InputProps:{disableUnderline:!0},fullWidth:!0,label:"Construction type",name:"construction_type",margin:"dense",defaultValue:o||"nil"}),i.a.createElement(Z.a,{key:c||"f_area",inputProps:{readOnly:!0,disabled:!0},InputProps:{disableUnderline:!0},fullWidth:!0,label:"Floor area",name:"floor_area",margin:"dense",defaultValue:c+" m\xb2"||!1}))),i.a.createElement(f.a,{item:!0,xs:6},i.a.createElement(f.a,{container:!0,alignItems:"center",justify:"space-between",className:u.heading},i.a.createElement(f.a,{item:!0},i.a.createElement(h.a,{variant:"h5",color:"textSecondary"},"Embodied emissions")),i.a.createElement(f.a,{item:!0},i.a.createElement(Kt,{iconSize:"default"}))),i.a.createElement(Ft,null))),i.a.createElement(f.a,{container:!0,spacing:3},i.a.createElement(f.a,{item:!0,xs:!0},i.a.createElement(Q.a,{variant:"middle",light:!0,className:u.divider}),i.a.createElement(Dt,null))))},Jt=Object(b.a)((function(e){return Object(p.a)({chart:{padding:e.spacing(2)}})})),Qt=function(){var e=Object(r.useRef)(null),t={force:!0,animate:!0},n=Object(r.useRef)(new ResizeObserver((function(n){var a;console.log("Size changed"),null===e||void 0===e||null===(a=e.current)||void 0===a||a.instance.render(t)}))),a=Object(r.useCallback)((function(e){null!==e?n.current.observe(e):n.current&&n.current.disconnect()}),[n.current]),l=Object(O.c)((function(e){return e.selectedBuildings})),o=Object(O.c)((function(e){return e.EEMetric})),c=Object(r.useState)([]),m=Object(u.a)(c,2),s=m[0],d=m[1];Object(r.useEffect)((function(){var e=[];l.forEach((function(t){var n=Number(t.A1A3)||0,a=Number(t.A4)||0,l=Number(t.B4_m)||0,r=Number(t.B4_t)||0;o.perSqM&&(n/=t.floor_area,a/=t.floor_area,l/=t.floor_area,r/=t.floor_area),o.perYear&&(n/=t.lifetime,a/=t.lifetime,l/=t.lifetime,r/=t.lifetime);var i={name:t.building_name,identifier:t.building_identifier,a1a3:n,a4:a,b4m:l,b4t:r};e.push(i)})),d(e.reverse())}),[l,o]);var g="kgCO2e";o.perSqM&&(g+="/m\xb2"),o.perYear&&(g+="/year");var E=Jt();return i.a.createElement(j.a,{ref:a},i.a.createElement(Fe.Chart,{className:E.chart,dataSource:s,palette:"Material",rotated:!0,ref:e},i.a.createElement(Fe.Size,{height:500}),i.a.createElement(Fe.CommonSeriesSettings,{argumentField:"name",type:"stackedBar",barWidth:60}),i.a.createElement(Fe.Series,{valueField:"a1a3",name:"A1-A3"}),i.a.createElement(Fe.Series,{valueField:"a4",name:"A4"}),i.a.createElement(Fe.Series,{valueField:"b4m",name:"B4 (m)"}),i.a.createElement(Fe.Series,{valueField:"b4t",name:"B4 (t)"}),i.a.createElement(Fe.ValueAxis,null,i.a.createElement(Fe.Title,{text:g,font:{size:14}})),i.a.createElement(Fe.ArgumentAxis,null,i.a.createElement(Fe.Label,{customizeText:function(e){if(e.value.length>17){var t=e.value.split(" ");return t.length>2?t.slice(0,2).join(" ")+"\n"+t.slice(2).join(" "):t.join("\n")}return e.value}})),i.a.createElement(Fe.Legend,{verticalAlignment:"bottom",horizontalAlignment:"center",itemTextPosition:"top",customizeHint:Ue}),i.a.createElement(Fe.Tooltip,{enabled:!0,location:"edge",customizeTooltip:function(e){return{text:"<b>".concat(e.seriesName,"</b>\n ").concat(e.valueText)}},zIndex:1200,arrowLength:6,format:{format:function(e){return parseFloat(e).toLocaleString()}}})))},Zt=Object(b.a)((function(e){return Object(p.a)({content:{padding:e.spacing(2)},heading:{marginBottom:e.spacing(1)}})})),en=function(){Object(O.b)(),Object(O.c)((function(e){return e.selectedBuildings}));var e=Zt();return i.a.createElement("div",{className:e.content},i.a.createElement(f.a,{container:!0,alignItems:"center",justify:"space-between",className:e.heading},i.a.createElement(f.a,{item:!0},i.a.createElement(h.a,{variant:"h5",color:"textSecondary"},"Embodied emissions")),i.a.createElement(f.a,{item:!0},i.a.createElement(Kt,{iconSize:"default"}))),i.a.createElement(Qt,null))},tn=Object(b.a)((function(e){return Object(p.a)({buildingSection:{marginBottom:e.spacing(2)},divider:{marginBottom:e.spacing(2)},elementSection:{marginTop:e.spacing(2)},buildingInfoLabels:{fontWeight:"bold"},noSelectionContainer:{height:"100vh"},drawer:{width:"50vw",flexShrink:0},drawerPaper:{width:"50vw",overflowY:"scroll"},content:{padding:e.spacing(2)}})})),nn=function(){Object(O.b)();var e=Object(O.c)((function(e){return e.selectedBuildings})),t=Object(O.c)((function(e){return e.canSelectMultipleBuildings})),n=tn();return i.a.createElement("div",null,e.length?t?i.a.createElement(en,null):i.a.createElement($t,null):i.a.createElement(f.a,{container:!0,justify:"center",alignItems:"center",className:n.noSelectionContainer},i.a.createElement(f.a,{item:!0,xs:12},i.a.createElement(h.a,{variant:"h5",color:"textSecondary",align:"center"},"Select a building"))))},an=n(270),ln=n.n(an),rn=n(539),on=n(269),cn=n.n(on),un=n(518),mn=(Object(de.a)((function(e){return Object(p.a)({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]},middleDivider:{marginTop:e.spacing(2)}})}))((function(e){var t=e.children,n=e.classes,a=e.onClose,l=Object(y.a)(e,["children","classes","onClose"]);return i.a.createElement(at.a,Object.assign({disableTypography:!0,className:n.root},l),i.a.createElement(h.a,{variant:"h6"},t),a?i.a.createElement(ye.a,{"aria-label":"close",className:n.closeButton,onClick:a},i.a.createElement(cn.a,null)):null)})),Object(de.a)((function(e){return{root:{padding:e.spacing(2)}}}))(rn.a)),sn=Object(de.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(nt.a),dn=[{term:"A1-A3",definition:"Material production"},{term:"A4",definition:"Transportation of materials to the building site"},{term:"B4 (m)",definition:"Material replacements throughout the study lifetime period"},{term:"B4 (t)",definition:"Transportation of material replacements"},{term:"RSL",definition:"Reference service life"}];var gn=function(){var e=i.a.useState(!1),t=Object(u.a)(e,2),n=t[0],a=t[1],l=function(){a(!1)};return i.a.createElement("div",null,i.a.createElement(me.a,{title:"Help"},i.a.createElement(ye.a,{"aria-label":"help",onClick:function(){a(!0)}},i.a.createElement(ln.a,{fontSize:"large"}))),i.a.createElement(tt.a,{onClose:l,open:n},i.a.createElement(mn,null,i.a.createElement(h.a,{variant:"h6"},"How to use"),i.a.createElement(h.a,null,i.a.createElement("ul",null,i.a.createElement("li",null,"Click on a row to see more details about the building, including its ",i.a.createElement("b",null,"materials")," and ",i.a.createElement("b",null,"building elements"),"."),i.a.createElement("li",null,"Turn on ",i.a.createElement("b",null,"Edit mode")," to edit a building's materials and see how the changes affect the rest of the building."),i.a.createElement("li",null,"Select multiple rows to ",i.a.createElement("b",null,"compare")," the emission values of different buildings."))),i.a.createElement(Q.a,{variant:"middle",light:!0,style:{marginBottom:"16px"}}),i.a.createElement(h.a,{variant:"h6"},"Terminology"),i.a.createElement(un.a,null,dn.map((function(e,t){return i.a.createElement(Wt.a,{key:t,divider:t<dn.length-1},i.a.createElement(f.a,{container:!0,spacing:1,alignItems:"center"},i.a.createElement(f.a,{item:!0,xs:2},i.a.createElement(h.a,{variant:"body1",color:"textSecondary"},e.term)),i.a.createElement(f.a,{item:!0,xs:10},i.a.createElement(h.a,{variant:"body1"},e.definition))))})))),i.a.createElement(sn,null,i.a.createElement(et.a,{autoFocus:!0,onClick:l,color:"primary"},"Close"))))},En=Object(b.a)((function(e){return Object(p.a)({container:{height:"100vh"},titleBar:{marginBottom:e.spacing(2)},content:{padding:e.spacing(2),boxSizing:"border-box"}})}));var bn=function(){var e=En();return i.a.createElement(E.a,{className:e.container,orientation:"vertical"},i.a.createElement(E.b,{className:e.content,minSize:400},i.a.createElement(f.a,{container:!0,alignItems:"center",justify:"space-between",spacing:2,className:e.titleBar},i.a.createElement(f.a,{item:!0},i.a.createElement(h.a,{variant:"h2",component:"h1"},"ExploreLCA")),i.a.createElement(f.a,{item:!0},i.a.createElement(gn,null))),i.a.createElement("div",{style:{height:"80vh"}},i.a.createElement(J,null))),i.a.createElement(E.c,null),i.a.createElement(E.b,{minSize:400},i.a.createElement("div",null,i.a.createElement(nn,null))))},pn=n(555),fn=n(542),hn=n(540),vn=n(544),yn=n(271),On=n.n(yn),An=n(541);function jn(){return i.a.createElement(h.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",i.a.createElement(hn.a,{color:"inherit",href:"https://github.com/ericvel"},"Eric Veliyulin")," ",(new Date).getFullYear(),".")}var Cn=Object(b.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));var Sn=function(){Object(O.b)();var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],l=Object(r.useState)(""),o=Object(u.a)(l,2),c=o[0],s=o[1],d=Object(r.useState)(null),g=Object(u.a)(d,2),E=g[0],b=g[1],p=function(e){var t=e.currentTarget,n=t.name,l=t.value;"email"===n?a(l):"password"===n&&s(l)},f=Cn();return i.a.createElement(An.a,{component:"main",maxWidth:"xs"},i.a.createElement(fn.a,null),i.a.createElement("div",{className:f.paper},i.a.createElement(pn.a,{className:f.avatar},i.a.createElement(On.a,null)),i.a.createElement(h.a,{component:"h1",variant:"h5"},"Sign in"),null!==E&&i.a.createElement(h.a,{color:"error"},"Error: ",E),i.a.createElement("form",{className:f.form,noValidate:!0,onSubmit:function(e){e.preventDefault()}},i.a.createElement(Z.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(e){return p(e)}}),i.a.createElement(Z.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){return p(e)}}),i.a.createElement(et.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:f.submit,onClick:function(e){!function(e,t,n){e.preventDefault(),m.a.auth().setPersistence(m.a.auth.Auth.Persistence.SESSION).then((function(){return m.a.auth().signInWithEmailAndPassword(t,n)})).catch((function(e){switch(e.code){case"auth/invalid-email":b("The email address is invalid");break;case"auth/wrong-password":b("The password is invalid");break;case"auth/user-not-found":b("The user does not exist")}console.error("Error signing in: ",e)}))}(e,n,c)}},"Sign In"))),i.a.createElement(vn.a,{mt:8},i.a.createElement(jn,null)))};var _n=function(){var e=Object(r.useState)(!1),t=Object(u.a)(e,2),n=t[0],a=t[1];return m.a.auth().onAuthStateChanged((function(e){a(!!e)})),n?i.a.createElement(s.a,{theme:g},i.a.createElement(bn,null)):i.a.createElement(Sn,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(456);var wn=n(106),Nn=n(56),Bn={idbuilding_elements:0,idlevels:0,name:"",hierarchy:0,A1A3:null,A4:null,B4_m:null,B4_t:null,idparent:null},Tn={perSqM:!0,perYear:!1},In=Object(wn.combineReducers)({buildings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BUILDINGS":return t.payload;default:return e}},selectedBuildings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_BUILDINGS":return t.payload;case"DESELECT_ALL_BUILDINGS":return[];default:return e}},isCompareDialogOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_COMPARE_DIALOG_OPEN":return!e;default:return e}},buildingElements:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BUILDING_ELEMENTS":return t.payload;default:return e}},materialInventory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MATERIAL_INVENTORY":return t.payload;default:return e}},selectedBuildingElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_BUILDING_ELEMENT":return t.payload;default:return e}},buildingElementRoute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TO_ELEMENT_ROUTE":return[].concat(Object(Nn.a)(e),[t.payload]);case"SET_BUILDING_ELEMENT_ROUTE":return t.payload;default:return e}},hoveredBuildingElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HOVER_BUILDING_ELEMENT":return t.payload;case"STOP_HOVER_BUILDING_ELEMENT":return null;default:return e}},materialsGroupBy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.Product,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONTENT_TYPE":return t.payload;default:return e}},displayMode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"table",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DISPLAY_MODE":return t.payload;default:return e}},canSelectMultipleBuildings:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_CAN_SELECT_MULTIPLE":return!e;default:return e}},isSimulationModeActive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_SIMULATION_MODE":return!e;default:return e}},EEMetric:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_EE_METRIC":return Object(Be.a)(Object(Be.a)({},e),{},Object(v.a)({},t.name,t.checked));default:return e}},simulatedData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SIMULATED_DATA":return t.payload;default:return e}},currentUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return t.payload;default:return e}},materialProducts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MATERIAL_PRODUCTS":return t.payload;default:return e}},simulatedMaterialProducts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SIMULATED_MATERIAL_PRODUCTS":return t.payload;default:return e}}});n(457);n(458).config();var xn=Object(wn.createStore)(In,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());c.a.render(i.a.createElement(O.a,{store:xn},i.a.createElement(_n,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[296,1,2]]]);
//# sourceMappingURL=main.9a534d4e.chunk.js.map